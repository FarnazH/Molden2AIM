# Molden2AIM
Molden2AIM is a utility program which can be used to creat AIM-WFN and NBO-47 files from a Molden file.

Version 3.1.0 (02/25/2015). Significant updates since version 3.0.0.
1. Supports the MOLDEN files generated by NWChem, BDF, PSI4 (spherical functions only), CADPAC, and MRCC.
2. Bug fix for NBO6.
3. ReOrdAtm.f90 has been updated for CFour.
4. Check the normalization of NBO's *.47 file.

# Features

1. It converts the data format from Molden to AIM's WFN. The latter format can be read by AIMPAC, AIMPAC2, AIM2000, AIMALL, AIM-UC, DGrid, MORPHY98, Multiwfn, PAMoC, ProMolden, TopChem, TopMoD, Xaim, and so on.
2. It saves NBO's *.47 data file. One can do NBO analysis using the stand-alone GENNBO program.

The WFX format will be supported in future.

# About the Molden file

Molden file can be generated using the following quantum chemistry programs, but some of them have not been supported by Molden2AIM.

1.	MOLPRO	Supported.
2.	MOLCAS	Both spherical and Cartesian functions are supported except their combinations; in the case of Cartesian functions insert a command line
[Program] Molcas
into the Molden file or specify PROGRAM=6 in the m2a.ini file.
3.	deMon2k	Supported.
4.	Q-Chem	Spherical S, P, D, and F or Cartesian S, P, and D basis functions.
5.	CFour	Use a fixed reorderdf.F a), and insert a command line
[Program] Cfour
into the Molden file or specify PROGRAM=2 in the m2a.ini file.
6.	Turbomole	Insert a command line
[Program] Turbomole
into the Molden file or specify PROGRAM=3 in the m2a.ini file.
7.	ORCA	Insert a command line
[Program] Orca
into the Molden file or specify PROGRAM=1 in the m2a.ini file.
8.	Columbus	Natural orbitals from MCSCF or CI with Cartesian SPDF functions b). Thanks to Dr. Marat Talipov for testing.
9.	Priroda	Thanks to Dr. Evgeniy Pankratyev for testing.
10.	DALTON 2013	HF c)/DFT c)/MP2/MCSCF with spherical basis functions.
11.	TeraChem	S, P, D, and F basis functions are supported.
12.	ACES-II 2.9	Use a fixed reorder.F d), and insert a command line
[Program] aces2
into the Molden file or specify PROGRAM=5 in the m2a.ini file.
13.	NWChem	Using JANPA/nwchem2molden to generate MOLDEN file.
14.	BDF	NR and SR with GTO. Thanks to Dr. Bingbing Suo for testing.
15.	PSI4	Spherical basis functions only; insert a command line
[Program] PSI4
into the Molden file or specify PROGRAM=7 in the m2a.ini file.
16.	CADPAC	The utility program cad2mol.f in MOLDEN is required to generate Molden file.
17.	MRCC	Both spherical and Cartesian functions are supported e). In the case of Cartesian functions insert a command line
[Program] MRCC
into the Molden file or specify PROGRAM=8 in the m2a.ini file.
18.	StoBe	To be tested.
19.	NRLMOL	To be tested.
20.	ADF	Not supported.
21.	Jaguar	Not supported f).

a) (CFour) Put reorderdf.F into $CFour/libr, and recompile the CFour program.
b) (Columbus) Dalton AO integrals have to be used; spherical basis functions cannot pass the examination; occupation numbers of HF and MCSCF MOs are wrong.
c) (Dalton 2013) Occupation numbers of HF and DFT are all zero values by mistake. One has to correct them by hand or by writing a script.
d) (ACES-II) Put reorder.F into $ACES-II-2.9.0/a2proc, and recompile the ACES-II 2.9 program. To reduce numerical errors, it is also recommended to modify $ACES-II-2.9.0/a2proc/molden_rdorb.F: replace the line 170
  130 format(I4,A,F12.6)
  by
  130 format(I4,A,F18.10)
e) (MRCC) To use spherical functions correctly, you have to update to the latest version of MRCC.
f) (Jaguar) One can insert a command line
  [Program] Jaguar
  into the Molden file or specify PROGRAM=4 in the m2a.ini file. However, the generated WFN file maybe cannot pass the checking of normalization.

# Limitations

1. In general, only S, P, D, F, and G Gaussian basis functions are supported by Molden2AIM. AIMALL and Multiwfn can also use H functions, however, which are not supported by the Molden format at present.
2. The total energy and virial ratio printed on the last line of the WFN file do not make sense. If they are used in your AIM analysis, please modify them manually.
3. The data saved in the *.47 file are very limited. For example, the "Second Order Perturbation Theory Analysis of Fock Matrix in NBO Basis" cannot be performed since the Fock matrix is absent.
4. Because of some uncertainties in the MOLDEN format, now the atomic indices must be ordered ascendingly (this is always checked). If not, a utility program roa (ReOrdAtm.f90) in util can be used to correct the Molden file.
